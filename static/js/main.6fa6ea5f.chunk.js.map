{"version":3,"sources":["common/spinner.module.css","common/spinner.js","utils/dates.js","components/prayerCard.js","utils/strings.js","components/selectList.js","App.js","index.js"],"names":["module","exports","spinner","container","row","react_default","a","createElement","className","styles","NAMES","require","timesFromStringtoDate","prayer","result","forEach","name","moment","timeString","day","_timeString$split","split","_timeString$split2","Object","slicedToArray","hour","minute","newDay","date","parseDateTime","PrayerCard","_ref","_useState","useState","_useState2","difference","setDifference","_useState3","_useState4","nextOne","setNextOne","times","updateDifference","nextOnes","keys","filter","t","isBefore","length","diff","format","useEffect","interval","setInterval","clearInterval","match","map","x","charAt","toUpperCase","slice","join","city","key","SelectList","values","onChange","value","c","id","API_URL","cleanLocalStorage","_len","arguments","args","Array","_key","objectSpread","localStorage","e","includes","removeItem","App","cities","setCities","prayers","setPrayers","_useState5","getItem","_useState6","setId","_init","asyncToGenerator","regenerator_default","mark","_callee","today","PRAYERS_KEY","URL","wrap","_context","prev","next","concat","month","t0","JSON","parse","axios","get","sent","data","setItem","stringify","t1","stop","apply","this","init","Fragment","prayerCard","find","selectList","target","common_spinner","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.6fa6ea5f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"spinner\":\"spinner_spinner__3ahFg\",\"container\":\"spinner_container__36_1M\",\"row\":\"spinner_row__2zXui\"};","import React from \"react\";\r\nimport styles from \"./spinner.module.css\";\r\n\r\nfunction spinner() {\r\n  return (\r\n    <div className={styles.container}>\r\n      <div className={styles.row}>\r\n        <div className={styles.spinner} />\r\n      </div>\r\n      <div className={styles.row}>\r\n        <h1> Loading </h1>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default spinner;\r\n","import moment from 'moment';\r\nconst NAMES = require('../data/prayers');\r\n\r\n\r\nexport const parseDateTime = (timeString, day) => {\r\n  const [hour, minute] = timeString.split(':');\r\n  const newDay = new moment();\r\n  newDay.date(day);\r\n  newDay.hour(hour);\r\n  newDay.minute(minute)\r\n  return newDay;\r\n};\r\n\r\nexport const timesFromStringtoDate = prayer => {\r\n  let result = {};\r\n  NAMES.forEach(name => {\r\n    result[name] = moment(parseDateTime(prayer[name], prayer.day));\r\n  });\r\n  return result;\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport moment from 'moment';\r\nimport 'moment/locale/fr';\r\nimport { timesFromStringtoDate } from '../utils/dates';\r\nimport { toTitleCase } from '../utils/strings';\r\nconst NAMES = require('../data/prayers');\r\n\r\n//TODO: extract to a lib\r\n\r\nconst PrayerCard = ({ prayer }) => {\r\n  let [difference, setDifference] = useState();\r\n  let [nextOne, setNextOne] = useState();\r\n  const times = timesFromStringtoDate(prayer);\r\n\r\n  const updateDifference = () => {\r\n    const nextOnes = Object.keys(times).filter(t =>\r\n      moment().isBefore(times[t])\r\n    );\r\n    nextOne = nextOnes.length === 0 ? NAMES[0] : nextOnes[0];\r\n    setNextOne(nextOne);\r\n    const diff = moment(times[nextOne].diff(moment())).format('HH:mm');\r\n    setDifference(diff);\r\n  };\r\n\r\n  useEffect(() => {\r\n    updateDifference();\r\n    const interval = setInterval(updateDifference, 60000);\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, [prayer]);\r\n\r\n  let date = toTitleCase(\r\n    moment(prayer.date)\r\n      // .locale(local)\r\n      .format('dddd LL')\r\n  );\r\n\r\n  // toTitleCase function does not work for arabic\r\n  // if (local !== 'ar') {\r\n  //   date = toTitleCase(date);\r\n  // }\r\n\r\n  return (\r\n    <div className=\"card\">\r\n      <h1>{prayer.city}</h1>\r\n      <h2>{date}</h2>\r\n      <ul>\r\n        {NAMES.map(name => {\r\n          return (\r\n            <li key={name} className={name === nextOne ? 'next-prayer' : ''}>\r\n              <span className=\"name\">{name}</span>\r\n              <span className=\"time\">{prayer[name]}</span>\r\n              {name === nextOne && (\r\n                <span className=\"difference\">{difference}</span>\r\n              )}\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n      <dl />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PrayerCard;\r\n","export const toTitleCase = str =>\r\n  str\r\n    .match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g)\r\n    .map(x => x.charAt(0).toUpperCase() + x.slice(1))\r\n    .join(' ');","import React from 'react';\r\n\r\nconst SelectList = ({ values, onChange, value }) => {\r\n  return (\r\n    <div className=\"select\">\r\n      <select value={value} onChange={onChange}>\r\n        {values.map(c => {\r\n          return (\r\n            <option value={c.id} key={c.id}>\r\n              {c.name}\r\n            </option>\r\n          );\r\n        })}\r\n      </select>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SelectList;\r\n","import React, { useState, useEffect } from 'react';\r\nimport 'reset-css';\r\nimport './App.css';\r\nimport axios from 'axios';\r\nimport moment from 'moment';\r\n\r\nimport Spinner from './common/spinner';\r\nimport PrayerCard from './components/prayerCard';\r\nimport SelectList from './components/selectList';\r\n\r\nconst API_URL = 'https://maroc-salat.herokuapp.com/';\r\n\r\nconst cleanLocalStorage = (...args) => {\r\n  const existing = Object.keys({ ...localStorage });\r\n  const toDelete = existing.filter(e => !args.includes(e));\r\n  toDelete.forEach(e => localStorage.removeItem(e));\r\n};\r\n\r\nconst App = () => {\r\n  let [cities, setCities] = useState();\r\n  let [prayers, setPrayers] = useState();\r\n  let [id, setId] = useState(+localStorage.getItem('id') || 1);\r\n\r\n  useEffect(() => {\r\n    async function init() {\r\n      const today = moment();\r\n      const PRAYERS_KEY = `prayers_${today.date()}_${today.month()}`;\r\n\r\n      //TODO: Extract a custom hook\r\n      const cities = localStorage.getItem('cities')\r\n        ? JSON.parse(localStorage.getItem('cities'))\r\n        : (await axios.get(`${API_URL}city`)).data;\r\n\r\n      setCities(cities);\r\n      localStorage.setItem('cities', JSON.stringify(cities));\r\n\r\n      const URL = `${API_URL}prayer?month=${today.month()}&day=${today.date()}`;\r\n\r\n      const prayers = localStorage.getItem(PRAYERS_KEY)\r\n        ? JSON.parse(localStorage.getItem(PRAYERS_KEY))\r\n        : (await axios.get(URL)).data;\r\n      setPrayers(prayers);\r\n      localStorage.setItem(PRAYERS_KEY, JSON.stringify(prayers));\r\n\r\n      cleanLocalStorage('cities', 'id', PRAYERS_KEY);\r\n    }\r\n\r\n    init();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('id', id);\r\n  }, [id]);\r\n\r\n  const onChange = e => {\r\n    const id = +e.target.value;\r\n    setId(id);\r\n  };\r\n\r\n  return (\r\n    <div id=\"main\">\r\n      {id && prayers ? (\r\n        <>\r\n          <PrayerCard prayer={prayers.find(e => e.id === id)} />\r\n          <SelectList value={id} values={cities} onChange={onChange} />\r\n        </>\r\n      ) : (\r\n        <Spinner />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(<App />, document.getElementById(\"root\"));\r\n"],"sourceRoot":""}